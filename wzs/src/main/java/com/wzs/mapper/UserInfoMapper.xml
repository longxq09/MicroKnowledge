<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wzs.mapper.UserInfoMapper">
    <sql id="BASE_TABLE">
        user_info
    </sql>

    <sql id="BASE_COLUMN">
        id,email,`name`,picture,sex,address,signature,education,works,expertise,interest,introduction,contribution
    </sql>

    <select id="findInfoById" resultType="com.wzs.bean.UserInfo" parameterType="int">
        select * from user_info where id = #{id}
    </select>
    <select id="findInfoByEmail" resultType="com.wzs.bean.UserInfo">
        select * from user_info where email = #{email}
    </select>

    <select id="getEmailCount" resultType="int">
        select count(*) from user_info where
        email = #{email}
    </select>

    <update id="editUserInfo" parameterType="com.wzs.bean.UserInfo" >
        update
            user_info usr
        left join
            micro_notice notice
        on
            usr.id = notice.authorId
        set
            usr.name = #{name, jdbcType=VARCHAR},
            usr.picture = #{picture, jdbcType=VARCHAR}
            usr.sex = #{sex,jdbcType=VARCHAR},
            usr.address=#{address,jdbcType=VARCHAR},
            usr.signature=#{signature,jdbcType=VARCHAR},
            usr.education=#{education,jdbcType=VARCHAR},
            usr.works=#{works,jdbcType=VARCHAR},
            usr.expertise=#{expertise,jdbcType=VARCHAR},
            usr.interest=#{interest,jdbcType=VARCHAR},
            usr.introduction=#{introduction},
            usr.contribution=#{contribution},
            notice.authorName = #{name, jdbcType=VARCHAR}
        where
            usr.id = #{id,jdbcType=INTEGER}
    </update>

    <insert id="addUserInfo" parameterType="com.wzs.bean.UserInfo">
        insert into user_info values
        (null,#{email},#{name},#{picture},#{sex},#{address},#{signature},#{education},#{works},
        #{expertise},#{interest},#{introduction},#{contribution})
    </insert>

    <select id="getAllInfos" resultType="com.wzs.bean.UserInfo">
        select * from user_info
    </select>

</mapper>